package {{LowerCase .ControllerName}}

import (
	"context"
	"{{.PackagePath}}/domain_{{.DomainName}}/usecase/{{SnakeCase .Usecase.Name}}"
	"{{.PackagePath}}/shared/lazygo"
	"{{.PackagePath}}/shared/model/stub"
	"{{.PackagePath}}/shared/infrastructure/logger"
	"{{.PackagePath}}/shared/util"
)

func (r *controller) {{CamelCase .Usecase.Name}}(ctx context.Context, stubReq *stub.{{CamelCase .Usecase.Name}}Request) (*stub.{{CamelCase .Usecase.Name}}Response, error) {

    type InportRequest = {{LowerCase .Usecase.Name}}.InportRequest
	type InportResponse = {{LowerCase .Usecase.Name}}.InportResponse

    inport := lazygo.GetInport[InportRequest, InportResponse](r.GetUsecase(InportRequest{}))

	var req InportRequest
	util.Automapper(stubReq, &req)
	r.log.Debug(ctx, "{{CamelCase .Usecase.Name}} request", r.log.Any("request", req))
	res, err := inport.Execute(ctx, req)
	if err != nil {
		return nil, err
	}

	var stubRes stub.{{CamelCase .Usecase.Name}}Response
	util.Automapper(res, &stubRes)
	r.log.Debug(ctx, "{{CamelCase .Usecase.Name}} response", r.log.Any("response", stubRes))

	return &stubRes, nil
}
